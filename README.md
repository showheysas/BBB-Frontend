## BBB-Frontend

# FACE GAUGE

**「FACE GAUGE」**は、カメラで顔を撮影し、顔の清潔感を3つの観点（スキンコンディション・トップフェイス・アンダーフェイス）からスコア化し、総合評価・アドバイス・おすすめ商品を提示する**Next.js製のWebアプリ**です。ローカルでの簡易測定と、バックエンドサーバーと連携した精密測定の2モードに対応しています。

---

## 📸 機能概要

- 顔検出と自動撮影（3秒カウントダウン）
- ローカルモードによる簡易スコア生成（ダミーデータ）
- バックエンドモードによる実測スコア取得（API連携）
- 各指標のレーダーチャート表示
- スコアに応じたコメントとおすすめ商品の提示
- 未ログイン・ゲストログイン・正式ログインの認証状態管理
- ナビゲーションバーでの画面移動や設定
- ログイン後のリダイレクト処理（状態保持）

---

## 🔧 使用技術

- **フロントエンド**: Next.js 14 (App Router), React, TypeScript, Tailwind CSS  
- **画像認識**: face-api.js（顔検出・切り出し）  
- **認証方式**: JWT（ローカルストレージに保存）  
- **チャート描画**: Recharts（RadarChart）  
- **バックエンド連携**: FastAPI（画像送信・スコア受信）

---

## 認証状態と画面遷移の仕様

| 状態 | ステータス | 表示される内容 |
|------|------------|----------------|
| 未ログイン | トークンなし | レーダーチャートまで／ログイン案内 |
| ゲストログイン | `username = 9999guest` | レーダーチャートまで／ログイン案内 |
| 正式ログイン | トークン + `username ≠ 9999guest` | 全スコア表示＋コメント＋商品＋次のアクション |

---

## モード切替とリセット

- モードは`localStorage`に保存され、ページ遷移しても保持されます。
- ナビバーの「モードリセット」で`mode`、トークン、ユーザー名をすべて初期化し、トップページにリダイレクトされます。

---

### 🔧 ディレクトリ構成と主な役割

```
BBB-Frontend/
├── public/                          # 静的アセット（画像・アイコン・モデル）を配置
│   ├── icons/                      # ナビゲーションやUI用アイコン
│   ├── images/                     # 写真やUI素材などの画像ファイル
│   └── models/                     # face-api.js で使用する顔認識モデル
│
├── src/                             # アプリのソースコードを格納
│   ├── app/                         # Next.js の App Router に基づくページディレクトリ
│   │   ├── camera/                  # カメラ起動・顔認識・自動撮影処理のページ
│   │   │   └── page.tsx
│   │   ├── check/                   # セルフチェック（手動入力）用ページ
│   │   │   └── page.tsx
│   │   ├── history/                 # 測定履歴の確認ページ（未実装または後方対応用）
│   │   │   └── page.tsx
│   │   ├── login/                   # ログイン機能に関連するページ
│   │   │   ├── LoginForm.tsx       # ログインフォームのUIと処理ロジック
│   │   │   └── page.tsx            # ログイン画面のエントリポイント
│   │   ├── register/               # 新規ユーザー登録ページ
│   │   │   ├── RegisterForm.tsx    # 登録フォームのUIと処理
│   │   │   └── page.tsx            # 新規登録ページのエントリポイント
│   │   ├── report/                 # おすすめ商品の表示ページ（測定後に遷移）
│   │   │   └── page.tsx
│   │   ├── result/                 # 測定結果（レーダーチャート・スコア等）の表示ページ
│   │   │   └── page.tsx
│   │   ├── settings/               # モード切替・リセット等の設定ページ
│   │   │   └── page.tsx
│   │   ├── todaysWord/             # 本日のひとこと・モチベーションメッセージページ
│   │   │   └── page.tsx
│   │   ├── favicon.ico             # ファビコン（ブラウザのタブ用アイコン）
│   │   ├── globals.css             # アプリ全体の共通スタイル定義
│   │   ├── layout.tsx              # App Router 共通レイアウト（Navbarなど）
│   │   └── page.tsx                # トップページ（エントリーポイント）
│   │ 
│   ├── components/                 # 再利用可能なUIコンポーネントを格納
│   │   └── Navbar.tsx              # 上部ナビゲーションバーのUIコンポーネント
│   │ 
│   └── lib/                        # 補助的なロジックやモックデータ
│       └── mockData.ts            # ダミーデータやコメント生成ロジックなどのユーティリティ
│
├── .gitignore                      # Gitで無視するファイル定義
├── eslint.config.mjs              # ESLint（静的コード解析）の設定
├── next-env.d.ts                  # TypeScript用のNext.jsの型定義
├── next.config.js                 # Next.jsの設定ファイル
├── package-lock.json              # 依存パッケージのロックファイル（バージョン固定）
├── package.json                   # 使用パッケージ・スクリプトの管理
├── postcss.config.mjs             # Tailwind CSS等で利用するPostCSSの設定
├── README.md                      # プロジェクトの概要・利用方法などの説明
└── tsconfig.json                  # TypeScriptの設定ファイル

```
---

## 🚀 セットアップ手順

```bash
git clone https://github.com/yourname/face-gauge.git
cd face-gauge
npm install
npm run dev
```
---

## 🧪 ローカルモードとバックエンドモードの切り替え

- `/settings` にてモード選択が可能です。

| モード | 説明 |
|-------|------|
| **ローカル** | 撮影後、ダミースコアを自動生成 |
| **バックエンド** | 撮影画像を API に `POST` → スコアとコメントを取得 |

---

## 🔐 認証仕様

### ローカルモード
- ユーザー名: `kiriyama`
- パスワード: `ren`

### バックエンドモード
- 実APIにログイン（例: `shosan` / `123`）

### 未ログイン時
- スコア測定を行うと、自動的に `9999guest` としてログインされます（バックエンドモード）

---

## 🧼 その他

- 一部に Next.js 推奨の `<Image>` コンポーネントを未使用（今後対応予定）
- ESLint および TypeScript の `strict` ルール対応中（※開発ビルドは可能）

---

## ✅ 今後の改善ポイント

- モバイル最適化の強化
- スコア履歴の保存・比較機能
- モード状態の Context 化による一貫性保持
- テスト実装（Jest / Playwright など）
